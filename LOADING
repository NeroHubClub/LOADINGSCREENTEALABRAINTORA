-- ============================================
-- PREMIUM LOADING SCREEN FOR DELTA EXECUTOR
-- Steal A Brainrots Script
-- Created by: Nero
-- ============================================

-- Services
local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local StarterGui = game:GetService("StarterGui")
local UserInputService = game:GetService("UserInputService")
local CoreGui = game:GetService("CoreGui")

-- Player
local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

-- Constants
local LOAD_DURATION = 160 -- seconds
local FADE_DURATION = 1.5 -- seconds

-- Create ScreenGui (DELTA COMPATIBLE VERSION)
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "PremiumLoaderV2"
screenGui.IgnoreGuiInset = true
screenGui.DisplayOrder = 100
screenGui.ResetOnSpawn = false
screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

-- Create main container
local mainContainer = Instance.new("Frame")
mainContainer.Name = "MainContainer"
mainContainer.Size = UDim2.new(1, 0, 1, 0)
mainContainer.Position = UDim2.new(0, 0, 0, 0)
mainContainer.BackgroundColor3 = Color3.fromRGB(10, 10, 15)
mainContainer.BackgroundTransparency = 1
mainContainer.BorderSizePixel = 0
mainContainer.Parent = screenGui

-- Create background with gradient
local background = Instance.new("Frame")
background.Name = "Background"
background.Size = UDim2.new(1, 0, 1, 0)
background.Position = UDim2.new(0, 0, 0, 0)
background.BackgroundColor3 = Color3.fromRGB(10, 10, 15)
background.BorderSizePixel = 0
background.Parent = mainContainer

-- Create animated gradient
local gradient = Instance.new("UIGradient")
gradient.Color = ColorSequence.new({
    ColorSequenceKeypoint.new(0, Color3.fromRGB(15, 15, 25)),
    ColorSequenceKeypoint.new(0.5, Color3.fromRGB(20, 20, 35)),
    ColorSequenceKeypoint.new(1, Color3.fromRGB(15, 15, 25))
})
gradient.Rotation = 45
gradient.Parent = background

-- Create glow effect (using multiple layers for better visuals)
local glowContainer = Instance.new("Frame")
glowContainer.Name = "GlowContainer"
glowContainer.Size = UDim2.new(1, 0, 1, 0)
glowContainer.BackgroundTransparency = 1
glowContainer.Parent = mainContainer

-- Glow 1
local glow1 = Instance.new("ImageLabel")
glow1.Name = "Glow1"
glow1.Size = UDim2.new(1, 400, 1, 400)
glow1.Position = UDim2.new(-0.5, -200, -0.5, -200)
glow1.BackgroundTransparency = 1
glow1.Image = "rbxassetid://9899474776" -- Using a Roblox gradient image
glow1.ImageTransparency = 0.8
glow1.ImageColor3 = Color3.fromRGB(80, 50, 150)
glow1.ScaleType = Enum.ScaleType.Slice
glow1.SliceCenter = Rect.new(100, 100, 100, 100)
glow1.Parent = glowContainer

-- Glow 2
local glow2 = Instance.new("ImageLabel")
glow2.Name = "Glow2"
glow2.Size = UDim2.new(1, 300, 1, 300)
glow2.Position = UDim2.new(-0.5, -150, -0.5, -150)
glow2.BackgroundTransparency = 1
glow2.Image = "rbxassetid://9899474776"
glow2.ImageTransparency = 0.7
glow2.ImageColor3 = Color3.fromRGB(120, 80, 200)
glow2.ScaleType = Enum.ScaleType.Slice
glow2.SliceCenter = Rect.new(100, 100, 100, 100)
glow2.Parent = glowContainer

-- Create content frame
local contentFrame = Instance.new("Frame")
contentFrame.Name = "ContentFrame"
contentFrame.Size = UDim2.new(0.8, 0, 0.6, 0)
contentFrame.Position = UDim2.new(0.1, 0, 0.2, 0)
contentFrame.BackgroundTransparency = 1
contentFrame.Parent = mainContainer

-- Create title
local title = Instance.new("TextLabel")
title.Name = "Title"
title.Size = UDim2.new(1, 0, 0.3, 0)
title.Position = UDim2.new(0, 0, 0.1, 0)
title.BackgroundTransparency = 1
title.Text = "Steal A Brainrots Script"
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.TextSize = 42
title.Font = Enum.Font.GothamBlack
title.TextTransparency = 1
title.TextStrokeTransparency = 0.8
title.TextStrokeColor3 = Color3.fromRGB(80, 50, 150)
title.Parent = contentFrame

-- Create subtitle
local subtitle = Instance.new("TextLabel")
subtitle.Name = "Subtitle"
subtitle.Size = UDim2.new(1, 0, 0.15, 0)
subtitle.Position = UDim2.new(0, 0, 0.4, 0)
subtitle.BackgroundTransparency = 1
subtitle.Text = "Created by: Nero"
subtitle.TextColor3 = Color3.fromRGB(180, 180, 220)
subtitle.TextSize = 24
subtitle.Font = Enum.Font.GothamMedium
subtitle.TextTransparency = 1
subtitle.Parent = contentFrame

-- Create loading bar container
local loadingBarContainer = Instance.new("Frame")
loadingBarContainer.Name = "LoadingBarContainer"
loadingBarContainer.Size = UDim2.new(1, 0, 0.15, 0)
loadingBarContainer.Position = UDim2.new(0, 0, 0.65, 0)
loadingBarContainer.BackgroundTransparency = 1
loadingBarContainer.Parent = contentFrame

-- Progress bar background
local progressBarBg = Instance.new("Frame")
progressBarBg.Name = "ProgressBarBg"
progressBarBg.Size = UDim2.new(1, 0, 0.4, 0)
progressBarBg.Position = UDim2.new(0, 0, 0.3, 0)
progressBarBg.BackgroundColor3 = Color3.fromRGB(30, 30, 45)
progressBarBg.BackgroundTransparency = 0.7
progressBarBg.BorderSizePixel = 0
progressBarBg.Parent = loadingBarContainer

-- Progress bar fill
local progressBar = Instance.new("Frame")
progressBar.Name = "ProgressBar"
progressBar.Size = UDim2.new(0, 0, 1, 0)
progressBar.Position = UDim2.new(0, 0, 0, 0)
progressBar.BackgroundColor3 = Color3.fromRGB(120, 80, 220)
progressBar.BorderSizePixel = 0
progressBar.Parent = progressBarBg

-- Progress bar gradient
local progressGradient = Instance.new("UIGradient")
progressGradient.Color = ColorSequence.new({
    ColorSequenceKeypoint.new(0, Color3.fromRGB(100, 60, 200)),
    ColorSequenceKeypoint.new(0.5, Color3.fromRGB(140, 90, 240)),
    ColorSequenceKeypoint.new(1, Color3.fromRGB(100, 60, 200))
})
progressGradient.Rotation = 90
progressGradient.Parent = progressBar

-- Create progress text
local progressText = Instance.new("TextLabel")
progressText.Name = "ProgressText"
progressText.Size = UDim2.new(1, 0, 0.3, 0)
progressText.Position = UDim2.new(0, 0, 0, -40)
progressText.BackgroundTransparency = 1
progressText.Text = "0%"
progressText.TextColor3 = Color3.fromRGB(200, 200, 255)
progressText.TextSize = 24
progressText.Font = Enum.Font.GothamBold
progressText.TextTransparency = 1
progressText.Parent = loadingBarContainer

-- Create status text
local statusText = Instance.new("TextLabel")
statusText.Name = "StatusText"
statusText.Size = UDim2.new(1, 0, 0.3, 0)
statusText.Position = UDim2.new(0, 0, 0.75, 0)
statusText.BackgroundTransparency = 1
statusText.Text = "Initializing..."
statusText.TextColor3 = Color3.fromRGB(150, 150, 180)
statusText.TextSize = 18
statusText.Font = Enum.Font.Gotham
statusText.TextTransparency = 1
statusText.Parent = loadingBarContainer

-- Create input blocker (DELTA FIX)
local inputBlocker = Instance.new("TextButton")
inputBlocker.Name = "InputBlocker"
inputBlocker.Size = UDim2.new(1, 0, 1, 0)
inputBlocker.Position = UDim2.new(0, 0, 0, 0)
inputBlocker.BackgroundTransparency = 1
inputBlocker.Text = ""
inputBlocker.TextTransparency = 1
inputBlocker.ZIndex = 100
inputBlocker.Parent = screenGui

-- Prevent input
inputBlocker.MouseButton1Down:Connect(function() end)
inputBlocker.MouseButton2Down:Connect(function() end)
inputBlocker.MouseButton1Up:Connect(function() end)
inputBlocker.MouseButton2Up:Connect(function() end)

-- Function to disable CoreGui
local function disableCoreGui()
    pcall(function()
        StarterGui:SetCoreGuiEnabled(Enum.CoreGuiType.All, false)
    end)
    
    -- Additional method for Delta compatibility
    pcall(function()
        for _, guiType in pairs(Enum.CoreGuiType:GetEnumItems()) do
            StarterGui:SetCore(guiType.Name .. "Enabled", false)
        end
    end)
end

-- Function to enable CoreGui
local function enableCoreGui()
    pcall(function()
        StarterGui:SetCoreGuiEnabled(Enum.CoreGuiType.All, true)
    end)
    
    -- Additional method for Delta compatibility
    pcall(function()
        for _, guiType in pairs(Enum.CoreGuiType:GetEnumItems()) do
            StarterGui:SetCore(guiType.Name .. "Enabled", true)
        end
    end)
end

-- Function to create particle effect
local function createParticleEffect()
    local particles = Instance.new("Frame")
    particles.Name = "Particles"
    particles.Size = UDim2.new(1, 0, 1, 0)
    particles.BackgroundTransparency = 1
    particles.Parent = mainContainer
    
    local function createParticle()
        local particle = Instance.new("Frame")
        particle.Size = UDim2.new(0, math.random(3, 8), 0, math.random(3, 8))
        particle.Position = UDim2.new(math.random(), 0, math.random(), 0)
        particle.BackgroundColor3 = Color3.fromRGB(120, 80, 220)
        particle.BackgroundTransparency = 0.8
        particle.BorderSizePixel = 0
        particle.ZIndex = 1
        particle.Parent = particles
        
        -- Animate particle
        spawn(function()
            local life = math.random(2, 4)
            local startPos = particle.Position
            local endPos = UDim2.new(math.random(), 0, math.random(), 0)
            
            for i = 0, 1, 0.02 do
                if particle and particle.Parent then
                    particle.Position = UDim2.new(
                        startPos.X.Scale + (endPos.X.Scale - startPos.X.Scale) * i,
                        startPos.X.Offset + (endPos.X.Offset - startPos.X.Offset) * i,
                        startPos.Y.Scale + (endPos.Y.Scale - startPos.Y.Scale) * i,
                        startPos.Y.Offset + (endPos.Y.Offset - startPos.Y.Offset) * i
                    )
                    particle.BackgroundTransparency = 0.8 + (0.2 * i)
                    wait(life * 0.02)
                else
                    break
                end
            end
            
            if particle and particle.Parent then
                particle:Destroy()
            end
        end)
        
        return particle
    end
    
    -- Particle spawner
    spawn(function()
        while screenGui.Parent do
            if particles:GetChildren() < 15 then
                createParticle()
            end
            wait(math.random(0.2, 0.5))
        end
    end)
    
    return particles
end

-- Function to animate glow
local function animateGlow()
    local angle = 0
    while screenGui.Parent do
        angle = (angle + 0.5) % 360
        glow1.Rotation = angle
        glow2.Rotation = -angle * 0.7
        RunService.RenderStepped:Wait()
    end
end

-- Function to show loading screen
local function showLoadingScreen()
    -- Disable CoreGui
    disableCoreGui()
    
    -- Insert screen gui
    screenGui.Parent = playerGui
    
    -- Create particle effect
    createParticleEffect()
    
    -- Start glow animation
    spawn(animateGlow)
    
    -- Fade in animation
    local fadeIn = TweenInfo.new(FADE_DURATION, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
    
    -- Fade in background
    TweenService:Create(mainContainer, fadeIn, {BackgroundTransparency = 0}):Play()
    
    -- Sequential fade in for text elements
    wait(0.3)
    TweenService:Create(title, fadeIn, {TextTransparency = 0}):Play()
    
    wait(0.2)
    TweenService:Create(subtitle, fadeIn, {TextTransparency = 0}):Play()
    
    wait(0.2)
    TweenService:Create(progressBarBg, fadeIn, {BackgroundTransparency = 0.7}):Play()
    TweenService:Create(progressText, fadeIn, {TextTransparency = 0}):Play()
    TweenService:Create(statusText, fadeIn, {TextTransparency = 0}):Play()
end

-- Function to update progress
local function updateProgress(percent)
    -- Update progress bar
    local barTween = TweenService:Create(
        progressBar, 
        TweenInfo.new(0.5, Enum.EasingStyle.Quad, Enum.EasingDirection.Out),
        {Size = UDim2.new(percent, 0, 1, 0)}
    )
    barTween:Play()
    
    -- Update percentage text
    local roundedPercent = math.floor(percent * 100)
    progressText.Text = roundedPercent .. "%"
    
    -- Update status text based on progress
    if percent < 0.25 then
        statusText.Text = "Loading modules..."
    elseif percent < 0.5 then
        statusText.Text = "Initializing scripts..."
    elseif percent < 0.75 then
        statusText.Text = "Processing assets..."
    else
        statusText.Text = "Finalizing..."
    end
end

-- Function to hide loading screen
local function hideLoadingScreen()
    local fadeOut = TweenInfo.new(FADE_DURATION, Enum.EasingStyle.Quad, Enum.EasingDirection.In)
    
    -- Fade out all elements
    TweenService:Create(title, fadeOut, {TextTransparency = 1}):Play()
    TweenService:Create(subtitle, fadeOut, {TextTransparency = 1}):Play()
    TweenService:Create(progressText, fadeOut, {TextTransparency = 1}):Play()
    TweenService:Create(statusText, fadeOut, {TextTransparency = 1}):Play()
    TweenService:Create(progressBarBg, fadeOut, {BackgroundTransparency = 1}):Play()
    TweenService:Create(mainContainer, fadeOut, {BackgroundTransparency = 1}):Play()
    
    wait(FADE_DURATION)
    
    -- Enable CoreGui
    enableCoreGui()
    
    -- Cleanup
    if screenGui and screenGui.Parent then
        screenGui:Destroy()
    end
end

-- Main loading function
local function startLoading()
    showLoadingScreen()
    
    local startTime = tick()
    local elapsed = 0
    
    while elapsed < LOAD_DURATION do
        elapsed = tick() - startTime
        local progress = math.min(elapsed / LOAD_DURATION, 1)
        
        updateProgress(progress)
        
        -- Smooth update rate
        RunService.RenderStepped:Wait()
    end
    
    -- Ensure 100%
    updateProgress(1)
    progressText.Text = "100%"
    statusText.Text = "Complete! Launching..."
    
    wait(1)
    
    hideLoadingScreen()
end

-- Error handling for Delta Executor
local function safeStart()
    local success, errorMsg = pcall(function()
        -- Additional Delta compatibility checks
        if not playerGui then
            playerGui = player:FindFirstChild("PlayerGui")
            if not playerGui then
                repeat wait() until player:FindFirstChild("PlayerGui")
                playerGui = player:FindFirstChild("PlayerGui")
            end
        end
        
        -- Start loading
        startLoading()
    end)
    
    if not success then
        -- Fallback simple loader if main one fails
        warn("Loader Error: " .. errorMsg)
        
        local simpleGui = Instance.new("ScreenGui")
        simpleGui.Name = "SimpleLoader"
        simpleGui.IgnoreGuiInset = true
        
        local frame = Instance.new("Frame")
        frame.Size = UDim2.new(1, 0, 1, 0)
        frame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
        frame.Parent = simpleGui
        
        local text = Instance.new("TextLabel")
        text.Size = UDim2.new(1, 0, 0.5, 0)
        text.Position = UDim2.new(0, 0, 0.25, 0)
        text.Text = "Steal A Brainrots Script\nCreated by: Nero"
        text.TextColor3 = Color3.fromRGB(255, 255, 255)
        text.TextSize = 24
        text.BackgroundTransparency = 1
        text.Parent = frame
        
        simpleGui.Parent = playerGui
        
        wait(5)
        simpleGui:Destroy()
    end
end

-- Start the loader with delay to ensure everything loads
wait(0.5)
safeStart()
